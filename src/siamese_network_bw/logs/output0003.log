I0607 15:28:53.840522 1956823808 caffe.cpp:99] Use GPU with device ID 0
I0607 15:28:54.625524 1956823808 caffe.cpp:107] Starting Optimization
I0607 15:28:54.625548 1956823808 solver.cpp:32] Initializing solver from parameters: 
test_iter: 100
test_interval: 500
base_lr: 0.01
display: 100
max_iter: 2000
lr_policy: "inv"
gamma: 0.0001
power: 0.75
momentum: 0.9
weight_decay: 0
snapshot: 0
snapshot_prefix: "src/siamese_network_bw/model/snapshots/siamese"
solver_mode: GPU
net: "src/siamese_network_bw/model/siamese_train_validate.prototxt"
I0607 15:28:54.625718 1956823808 solver.cpp:70] Creating training net from net file: src/siamese_network_bw/model/siamese_train_validate.prototxt
I0607 15:28:54.626924 1956823808 net.cpp:260] The NetState phase (0) differed from the phase (1) specified by a rule in layer pair_data
I0607 15:28:54.626957 1956823808 net.cpp:39] Initializing net from parameters: 
name: "siamese_train_validate"
state {
  phase: TRAIN
}
layer {
  name: "pair_data"
  type: "Data"
  top: "pair_data"
  top: "sim"
  include {
    phase: TRAIN
  }
  transform_param {
    scale: 1
  }
  data_param {
    source: "src/siamese_network_bw/data/siamese_network_train_leveldb"
    batch_size: 64
  }
}
layer {
  name: "slice_pair"
  type: "Slice"
  bottom: "pair_data"
  top: "data"
  top: "data_p"
  slice_param {
    slice_dim: 1
    slice_point: 1
  }
}
layer {
  name: "conv1"
  type: "Convolution"
  bottom: "data"
  top: "conv1"
  param {
    name: "conv1_w"
    lr_mult: 1
  }
  param {
    name: "conv1_b"
    lr_mult: 2
  }
  convolution_param {
    num_output: 20
    kernel_size: 5
    stride: 1
    weight_filler {
      type: "xavier"
    }
    bias_filler {
      type: "constant"
    }
  }
}
layer {
  name: "pool1"
  type: "Pooling"
  bottom: "conv1"
  top: "pool1"
  pooling_param {
    pool: MAX
    kernel_size: 2
    stride: 2
  }
}
layer {
  name: "conv2"
  type: "Convolution"
  bottom: "pool1"
  top: "conv2"
  param {
    name: "conv2_w"
    lr_mult: 1
  }
  param {
    name: "conv2_b"
    lr_mult: 2
  }
  convolution_param {
    num_output: 50
    kernel_size: 5
    stride: 1
    weight_filler {
      type: "xavier"
    }
    bias_filler {
      type: "constant"
    }
  }
}
layer {
  name: "pool2"
  type: "Pooling"
  bottom: "conv2"
  top: "pool2"
  pooling_param {
    pool: MAX
    kernel_size: 2
    stride: 2
  }
}
layer {
  name: "ip1"
  type: "InnerProduct"
  bottom: "pool2"
  top: "ip1"
  param {
    name: "ip1_w"
    lr_mult: 1
  }
  param {
    name: "ip1_b"
    lr_mult: 2
  }
  inner_product_param {
    num_output: 500
    weight_filler {
      type: "xavier"
    }
    bias_filler {
      type: "constant"
    }
  }
}
layer {
  name: "relu1"
  type: "ReLU"
  bottom: "ip1"
  top: "ip1"
}
layer {
  name: "ip2"
  type: "InnerProduct"
  bottom: "ip1"
  top: "ip2"
  param {
    name: "ip2_w"
    lr_mult: 1
  }
  param {
    name: "ip2_b"
    lr_mult: 2
  }
  inner_product_param {
    num_output: 10
    weight_filler {
      type: "xavier"
    }
    bias_filler {
      type: "constant"
    }
  }
}
layer {
  name: "feat"
  type: "InnerProduct"
  bottom: "ip2"
  top: "feat"
  param {
    name: "feat_w"
    lr_mult: 1
  }
  param {
    name: "feat_b"
    lr_mult: 2
  }
  inner_product_param {
    num_output: 2
    weight_filler {
      type: "xavier"
    }
    bias_filler {
      type: "constant"
    }
  }
}
layer {
  name: "conv1_p"
  type: "Convolution"
  bottom: "data_p"
  top: "conv1_p"
  param {
    name: "conv1_w"
    lr_mult: 1
  }
  param {
    name: "conv1_b"
    lr_mult: 2
  }
  convolution_param {
    num_output: 20
    kernel_size: 5
    stride: 1
    weight_filler {
      type: "xavier"
    }
    bias_filler {
      type: "constant"
    }
  }
}
layer {
  name: "pool1_p"
  type: "Pooling"
  bottom: "conv1_p"
  top: "pool1_p"
  pooling_param {
    pool: MAX
    kernel_size: 2
    stride: 2
  }
}
layer {
  name: "conv2_p"
  type: "Convolution"
  bottom: "pool1_p"
  top: "conv2_p"
  param {
    name: "conv2_w"
    lr_mult: 1
  }
  param {
    name: "conv2_b"
    lr_mult: 2
  }
  convolution_param {
    num_output: 50
    kernel_size: 5
    stride: 1
    weight_filler {
      type: "xavier"
    }
    bias_filler {
      type: "constant"
    }
  }
}
layer {
  name: "pool2_p"
  type: "Pooling"
  bottom: "conv2_p"
  top: "pool2_p"
  pooling_param {
    pool: MAX
    kernel_size: 2
    stride: 2
  }
}
layer {
  name: "ip1_p"
  type: "InnerProduct"
  bottom: "pool2_p"
  top: "ip1_p"
  param {
    name: "ip1_w"
    lr_mult: 1
  }
  param {
    name: "ip1_b"
    lr_mult: 2
  }
  inner_product_param {
    num_output: 500
    weight_filler {
      type: "xavier"
    }
    bias_filler {
      type: "constant"
    }
  }
}
layer {
  name: "relu1_p"
  type: "ReLU"
  bottom: "ip1_p"
  top: "ip1_p"
}
layer {
  name: "ip2_p"
  type: "InnerProduct"
  bottom: "ip1_p"
  top: "ip2_p"
  param {
    name: "ip2_w"
    lr_mult: 1
  }
  param {
    name: "ip2_b"
    lr_mult: 2
  }
  inner_product_param {
    num_output: 10
    weight_filler {
      type: "xavier"
    }
    bias_filler {
      type: "constant"
    }
  }
}
layer {
  name: "feat_p"
  type: "InnerProduct"
  bottom: "ip2_p"
  top: "feat_p"
  param {
    name: "feat_w"
    lr_mult: 1
  }
  param {
    name: "feat_b"
    lr_mult: 2
  }
  inner_product_param {
    num_output: 2
    weight_filler {
      type: "xavier"
    }
    bias_filler {
      type: "constant"
    }
  }
}
layer {
  name: "loss"
  type: "ContrastiveLoss"
  bottom: "feat"
  bottom: "feat_p"
  bottom: "sim"
  top: "loss"
  contrastive_loss_param {
    margin: 1
  }
}
I0607 15:28:54.627588 1956823808 layer_factory.hpp:74] Creating layer pair_data
I0607 15:28:54.627612 1956823808 net.cpp:69] Creating Layer pair_data
I0607 15:28:54.627624 1956823808 net.cpp:341] pair_data -> pair_data
I0607 15:28:54.627648 1956823808 net.cpp:341] pair_data -> sim
I0607 15:28:54.627662 1956823808 net.cpp:98] Setting up pair_data
I0607 15:28:54.629662 1956823808 db.cpp:20] Opened leveldb src/siamese_network_bw/data/siamese_network_train_leveldb
I0607 15:28:54.631157 1956823808 data_layer.cpp:65] output data size: 64,2,62,47
I0607 15:28:54.631832 1956823808 net.cpp:105] Top shape: 64 2 62 47 (372992)
I0607 15:28:54.631841 1956823808 net.cpp:105] Top shape: 64 1 1 1 (64)
I0607 15:28:54.631846 1956823808 layer_factory.hpp:74] Creating layer slice_pair
I0607 15:28:54.631857 1956823808 net.cpp:69] Creating Layer slice_pair
I0607 15:28:54.631862 1956823808 net.cpp:379] slice_pair <- pair_data
I0607 15:28:54.631870 1956823808 net.cpp:341] slice_pair -> data
I0607 15:28:54.631878 1956823808 net.cpp:341] slice_pair -> data_p
I0607 15:28:54.631886 1956823808 net.cpp:98] Setting up slice_pair
I0607 15:28:54.631891 1956823808 net.cpp:105] Top shape: 64 1 62 47 (186496)
I0607 15:28:54.631896 1956823808 net.cpp:105] Top shape: 64 1 62 47 (186496)
I0607 15:28:54.631898 1956823808 layer_factory.hpp:74] Creating layer conv1
I0607 15:28:54.631904 1956823808 net.cpp:69] Creating Layer conv1
I0607 15:28:54.631907 1956823808 net.cpp:379] conv1 <- data
I0607 15:28:54.631916 1956823808 net.cpp:341] conv1 -> conv1
I0607 15:28:54.631922 1956823808 net.cpp:98] Setting up conv1
I0607 15:28:54.714510 1956823808 net.cpp:105] Top shape: 64 20 58 43 (3192320)
I0607 15:28:54.714539 1956823808 layer_factory.hpp:74] Creating layer pool1
I0607 15:28:54.714548 1956823808 net.cpp:69] Creating Layer pool1
I0607 15:28:54.714552 1956823808 net.cpp:379] pool1 <- conv1
I0607 15:28:54.714560 1956823808 net.cpp:341] pool1 -> pool1
I0607 15:28:54.714568 1956823808 net.cpp:98] Setting up pool1
I0607 15:28:54.714892 1956823808 net.cpp:105] Top shape: 64 20 29 22 (816640)
I0607 15:28:54.714908 1956823808 layer_factory.hpp:74] Creating layer conv2
I0607 15:28:54.714925 1956823808 net.cpp:69] Creating Layer conv2
I0607 15:28:54.714932 1956823808 net.cpp:379] conv2 <- pool1
I0607 15:28:54.714943 1956823808 net.cpp:341] conv2 -> conv2
I0607 15:28:54.714956 1956823808 net.cpp:98] Setting up conv2
I0607 15:28:54.715615 1956823808 net.cpp:105] Top shape: 64 50 25 18 (1440000)
I0607 15:28:54.715629 1956823808 layer_factory.hpp:74] Creating layer pool2
I0607 15:28:54.715644 1956823808 net.cpp:69] Creating Layer pool2
I0607 15:28:54.715648 1956823808 net.cpp:379] pool2 <- conv2
I0607 15:28:54.715708 1956823808 net.cpp:341] pool2 -> pool2
I0607 15:28:54.715720 1956823808 net.cpp:98] Setting up pool2
I0607 15:28:54.715788 1956823808 net.cpp:105] Top shape: 64 50 13 9 (374400)
I0607 15:28:54.715811 1956823808 layer_factory.hpp:74] Creating layer ip1
I0607 15:28:54.715826 1956823808 net.cpp:69] Creating Layer ip1
I0607 15:28:54.715852 1956823808 net.cpp:379] ip1 <- pool2
I0607 15:28:54.715867 1956823808 net.cpp:341] ip1 -> ip1
I0607 15:28:54.715881 1956823808 net.cpp:98] Setting up ip1
I0607 15:28:54.737989 1956823808 net.cpp:105] Top shape: 64 500 1 1 (32000)
I0607 15:28:54.738020 1956823808 layer_factory.hpp:74] Creating layer relu1
I0607 15:28:54.738031 1956823808 net.cpp:69] Creating Layer relu1
I0607 15:28:54.738036 1956823808 net.cpp:379] relu1 <- ip1
I0607 15:28:54.738044 1956823808 net.cpp:330] relu1 -> ip1 (in-place)
I0607 15:28:54.738050 1956823808 net.cpp:98] Setting up relu1
I0607 15:28:54.738133 1956823808 net.cpp:105] Top shape: 64 500 1 1 (32000)
I0607 15:28:54.738138 1956823808 layer_factory.hpp:74] Creating layer ip2
I0607 15:28:54.738148 1956823808 net.cpp:69] Creating Layer ip2
I0607 15:28:54.738152 1956823808 net.cpp:379] ip2 <- ip1
I0607 15:28:54.738159 1956823808 net.cpp:341] ip2 -> ip2
I0607 15:28:54.738168 1956823808 net.cpp:98] Setting up ip2
I0607 15:28:54.738221 1956823808 net.cpp:105] Top shape: 64 10 1 1 (640)
I0607 15:28:54.738229 1956823808 layer_factory.hpp:74] Creating layer feat
I0607 15:28:54.738235 1956823808 net.cpp:69] Creating Layer feat
I0607 15:28:54.738273 1956823808 net.cpp:379] feat <- ip2
I0607 15:28:54.738312 1956823808 net.cpp:341] feat -> feat
I0607 15:28:54.738348 1956823808 net.cpp:98] Setting up feat
I0607 15:28:54.738368 1956823808 net.cpp:105] Top shape: 64 2 1 1 (128)
I0607 15:28:54.738391 1956823808 layer_factory.hpp:74] Creating layer conv1_p
I0607 15:28:54.738407 1956823808 net.cpp:69] Creating Layer conv1_p
I0607 15:28:54.738414 1956823808 net.cpp:379] conv1_p <- data_p
I0607 15:28:54.738430 1956823808 net.cpp:341] conv1_p -> conv1_p
I0607 15:28:54.738461 1956823808 net.cpp:98] Setting up conv1_p
I0607 15:28:54.738848 1956823808 net.cpp:105] Top shape: 64 20 58 43 (3192320)
I0607 15:28:54.738860 1956823808 net.cpp:423] Sharing parameters 'conv1_w' owned by layer 'conv1', param index 0
I0607 15:28:54.738880 1956823808 net.cpp:423] Sharing parameters 'conv1_b' owned by layer 'conv1', param index 1
I0607 15:28:54.738895 1956823808 layer_factory.hpp:74] Creating layer pool1_p
I0607 15:28:54.738909 1956823808 net.cpp:69] Creating Layer pool1_p
I0607 15:28:54.738925 1956823808 net.cpp:379] pool1_p <- conv1_p
I0607 15:28:54.738940 1956823808 net.cpp:341] pool1_p -> pool1_p
I0607 15:28:54.738948 1956823808 net.cpp:98] Setting up pool1_p
I0607 15:28:54.739065 1956823808 net.cpp:105] Top shape: 64 20 29 22 (816640)
I0607 15:28:54.739073 1956823808 layer_factory.hpp:74] Creating layer conv2_p
I0607 15:28:54.739099 1956823808 net.cpp:69] Creating Layer conv2_p
I0607 15:28:54.739109 1956823808 net.cpp:379] conv2_p <- pool1_p
I0607 15:28:54.739115 1956823808 net.cpp:341] conv2_p -> conv2_p
I0607 15:28:54.739122 1956823808 net.cpp:98] Setting up conv2_p
I0607 15:28:54.739704 1956823808 net.cpp:105] Top shape: 64 50 25 18 (1440000)
I0607 15:28:54.739719 1956823808 net.cpp:423] Sharing parameters 'conv2_w' owned by layer 'conv2', param index 0
I0607 15:28:54.739728 1956823808 net.cpp:423] Sharing parameters 'conv2_b' owned by layer 'conv2', param index 1
I0607 15:28:54.739737 1956823808 layer_factory.hpp:74] Creating layer pool2_p
I0607 15:28:54.739747 1956823808 net.cpp:69] Creating Layer pool2_p
I0607 15:28:54.739753 1956823808 net.cpp:379] pool2_p <- conv2_p
I0607 15:28:54.739763 1956823808 net.cpp:341] pool2_p -> pool2_p
I0607 15:28:54.739773 1956823808 net.cpp:98] Setting up pool2_p
I0607 15:28:54.739836 1956823808 net.cpp:105] Top shape: 64 50 13 9 (374400)
I0607 15:28:54.739845 1956823808 layer_factory.hpp:74] Creating layer ip1_p
I0607 15:28:54.739856 1956823808 net.cpp:69] Creating Layer ip1_p
I0607 15:28:54.739862 1956823808 net.cpp:379] ip1_p <- pool2_p
I0607 15:28:54.739905 1956823808 net.cpp:341] ip1_p -> ip1_p
I0607 15:28:54.739914 1956823808 net.cpp:98] Setting up ip1_p
I0607 15:28:54.762889 1956823808 net.cpp:105] Top shape: 64 500 1 1 (32000)
I0607 15:28:54.762912 1956823808 net.cpp:423] Sharing parameters 'ip1_w' owned by layer 'ip1', param index 0
I0607 15:28:54.763721 1956823808 net.cpp:423] Sharing parameters 'ip1_b' owned by layer 'ip1', param index 1
I0607 15:28:54.763731 1956823808 layer_factory.hpp:74] Creating layer relu1_p
I0607 15:28:54.763741 1956823808 net.cpp:69] Creating Layer relu1_p
I0607 15:28:54.763744 1956823808 net.cpp:379] relu1_p <- ip1_p
I0607 15:28:54.763751 1956823808 net.cpp:330] relu1_p -> ip1_p (in-place)
I0607 15:28:54.763756 1956823808 net.cpp:98] Setting up relu1_p
I0607 15:28:54.763829 1956823808 net.cpp:105] Top shape: 64 500 1 1 (32000)
I0607 15:28:54.763834 1956823808 layer_factory.hpp:74] Creating layer ip2_p
I0607 15:28:54.763844 1956823808 net.cpp:69] Creating Layer ip2_p
I0607 15:28:54.763846 1956823808 net.cpp:379] ip2_p <- ip1_p
I0607 15:28:54.763852 1956823808 net.cpp:341] ip2_p -> ip2_p
I0607 15:28:54.763864 1956823808 net.cpp:98] Setting up ip2_p
I0607 15:28:54.763907 1956823808 net.cpp:105] Top shape: 64 10 1 1 (640)
I0607 15:28:54.763914 1956823808 net.cpp:423] Sharing parameters 'ip2_w' owned by layer 'ip2', param index 0
I0607 15:28:54.763918 1956823808 net.cpp:423] Sharing parameters 'ip2_b' owned by layer 'ip2', param index 1
I0607 15:28:54.763922 1956823808 layer_factory.hpp:74] Creating layer feat_p
I0607 15:28:54.763929 1956823808 net.cpp:69] Creating Layer feat_p
I0607 15:28:54.763932 1956823808 net.cpp:379] feat_p <- ip2_p
I0607 15:28:54.763939 1956823808 net.cpp:341] feat_p -> feat_p
I0607 15:28:54.763947 1956823808 net.cpp:98] Setting up feat_p
I0607 15:28:54.763953 1956823808 net.cpp:105] Top shape: 64 2 1 1 (128)
I0607 15:28:54.763957 1956823808 net.cpp:423] Sharing parameters 'feat_w' owned by layer 'feat', param index 0
I0607 15:28:54.763962 1956823808 net.cpp:423] Sharing parameters 'feat_b' owned by layer 'feat', param index 1
I0607 15:28:54.763964 1956823808 layer_factory.hpp:74] Creating layer loss
I0607 15:28:54.763973 1956823808 net.cpp:69] Creating Layer loss
I0607 15:28:54.763977 1956823808 net.cpp:379] loss <- feat
I0607 15:28:54.763980 1956823808 net.cpp:379] loss <- feat_p
I0607 15:28:54.763985 1956823808 net.cpp:379] loss <- sim
I0607 15:28:54.763989 1956823808 net.cpp:341] loss -> loss
I0607 15:28:54.763995 1956823808 net.cpp:98] Setting up loss
I0607 15:28:54.764000 1956823808 net.cpp:105] Top shape: 1 1 1 1 (1)
I0607 15:28:54.764004 1956823808 net.cpp:111]     with loss weight 1
I0607 15:28:54.764016 1956823808 net.cpp:156] loss needs backward computation.
I0607 15:28:54.764019 1956823808 net.cpp:156] feat_p needs backward computation.
I0607 15:28:54.764024 1956823808 net.cpp:156] ip2_p needs backward computation.
I0607 15:28:54.764026 1956823808 net.cpp:156] relu1_p needs backward computation.
I0607 15:28:54.764029 1956823808 net.cpp:156] ip1_p needs backward computation.
I0607 15:28:54.764034 1956823808 net.cpp:156] pool2_p needs backward computation.
I0607 15:28:54.764036 1956823808 net.cpp:156] conv2_p needs backward computation.
I0607 15:28:54.764039 1956823808 net.cpp:156] pool1_p needs backward computation.
I0607 15:28:54.764044 1956823808 net.cpp:156] conv1_p needs backward computation.
I0607 15:28:54.764046 1956823808 net.cpp:156] feat needs backward computation.
I0607 15:28:54.764050 1956823808 net.cpp:156] ip2 needs backward computation.
I0607 15:28:54.764053 1956823808 net.cpp:156] relu1 needs backward computation.
I0607 15:28:54.764056 1956823808 net.cpp:156] ip1 needs backward computation.
I0607 15:28:54.764060 1956823808 net.cpp:156] pool2 needs backward computation.
I0607 15:28:54.764063 1956823808 net.cpp:156] conv2 needs backward computation.
I0607 15:28:54.764066 1956823808 net.cpp:156] pool1 needs backward computation.
I0607 15:28:54.764070 1956823808 net.cpp:156] conv1 needs backward computation.
I0607 15:28:54.764073 1956823808 net.cpp:158] slice_pair does not need backward computation.
I0607 15:28:54.764098 1956823808 net.cpp:158] pair_data does not need backward computation.
I0607 15:28:54.764102 1956823808 net.cpp:194] This network produces output loss
I0607 15:28:54.764117 1956823808 net.cpp:453] Collecting Learning Rate and Weight Decay.
I0607 15:28:54.764125 1956823808 net.cpp:206] Network initialization done.
I0607 15:28:54.764128 1956823808 net.cpp:207] Memory required for data: 50089220
I0607 15:28:54.765099 1956823808 solver.cpp:154] Creating test net (#0) specified by net file: src/siamese_network_bw/model/siamese_train_validate.prototxt
I0607 15:28:54.765193 1956823808 net.cpp:260] The NetState phase (1) differed from the phase (0) specified by a rule in layer pair_data
I0607 15:28:54.765226 1956823808 net.cpp:39] Initializing net from parameters: 
name: "siamese_train_validate"
state {
  phase: TEST
}
layer {
  name: "pair_data"
  type: "Data"
  top: "pair_data"
  top: "sim"
  include {
    phase: TEST
  }
  transform_param {
    scale: 1
  }
  data_param {
    source: "src/siamese_network_bw/data/siamese_network_validation_leveldb"
    batch_size: 100
  }
}
layer {
  name: "slice_pair"
  type: "Slice"
  bottom: "pair_data"
  top: "data"
  top: "data_p"
  slice_param {
    slice_dim: 1
    slice_point: 1
  }
}
layer {
  name: "conv1"
  type: "Convolution"
  bottom: "data"
  top: "conv1"
  param {
    name: "conv1_w"
    lr_mult: 1
  }
  param {
    name: "conv1_b"
    lr_mult: 2
  }
  convolution_param {
    num_output: 20
    kernel_size: 5
    stride: 1
    weight_filler {
      type: "xavier"
    }
    bias_filler {
      type: "constant"
    }
  }
}
layer {
  name: "pool1"
  type: "Pooling"
  bottom: "conv1"
  top: "pool1"
  pooling_param {
    pool: MAX
    kernel_size: 2
    stride: 2
  }
}
layer {
  name: "conv2"
  type: "Convolution"
  bottom: "pool1"
  top: "conv2"
  param {
    name: "conv2_w"
    lr_mult: 1
  }
  param {
    name: "conv2_b"
    lr_mult: 2
  }
  convolution_param {
    num_output: 50
    kernel_size: 5
    stride: 1
    weight_filler {
      type: "xavier"
    }
    bias_filler {
      type: "constant"
    }
  }
}
layer {
  name: "pool2"
  type: "Pooling"
  bottom: "conv2"
  top: "pool2"
  pooling_param {
    pool: MAX
    kernel_size: 2
    stride: 2
  }
}
layer {
  name: "ip1"
  type: "InnerProduct"
  bottom: "pool2"
  top: "ip1"
  param {
    name: "ip1_w"
    lr_mult: 1
  }
  param {
    name: "ip1_b"
    lr_mult: 2
  }
  inner_product_param {
    num_output: 500
    weight_filler {
      type: "xavier"
    }
    bias_filler {
      type: "constant"
    }
  }
}
layer {
  name: "relu1"
  type: "ReLU"
  bottom: "ip1"
  top: "ip1"
}
layer {
  name: "ip2"
  type: "InnerProduct"
  bottom: "ip1"
  top: "ip2"
  param {
    name: "ip2_w"
    lr_mult: 1
  }
  param {
    name: "ip2_b"
    lr_mult: 2
  }
  inner_product_param {
    num_output: 10
    weight_filler {
      type: "xavier"
    }
    bias_filler {
      type: "constant"
    }
  }
}
layer {
  name: "feat"
  type: "InnerProduct"
  bottom: "ip2"
  top: "feat"
  param {
    name: "feat_w"
    lr_mult: 1
  }
  param {
    name: "feat_b"
    lr_mult: 2
  }
  inner_product_param {
    num_output: 2
    weight_filler {
      type: "xavier"
    }
    bias_filler {
      type: "constant"
    }
  }
}
layer {
  name: "conv1_p"
  type: "Convolution"
  bottom: "data_p"
  top: "conv1_p"
  param {
    name: "conv1_w"
    lr_mult: 1
  }
  param {
    name: "conv1_b"
    lr_mult: 2
  }
  convolution_param {
    num_output: 20
    kernel_size: 5
    stride: 1
    weight_filler {
      type: "xavier"
    }
    bias_filler {
      type: "constant"
    }
  }
}
layer {
  name: "pool1_p"
  type: "Pooling"
  bottom: "conv1_p"
  top: "pool1_p"
  pooling_param {
    pool: MAX
    kernel_size: 2
    stride: 2
  }
}
layer {
  name: "conv2_p"
  type: "Convolution"
  bottom: "pool1_p"
  top: "conv2_p"
  param {
    name: "conv2_w"
    lr_mult: 1
  }
  param {
    name: "conv2_b"
    lr_mult: 2
  }
  convolution_param {
    num_output: 50
    kernel_size: 5
    stride: 1
    weight_filler {
      type: "xavier"
    }
    bias_filler {
      type: "constant"
    }
  }
}
layer {
  name: "pool2_p"
  type: "Pooling"
  bottom: "conv2_p"
  top: "pool2_p"
  pooling_param {
    pool: MAX
    kernel_size: 2
    stride: 2
  }
}
layer {
  name: "ip1_p"
  type: "InnerProduct"
  bottom: "pool2_p"
  top: "ip1_p"
  param {
    name: "ip1_w"
    lr_mult: 1
  }
  param {
    name: "ip1_b"
    lr_mult: 2
  }
  inner_product_param {
    num_output: 500
    weight_filler {
      type: "xavier"
    }
    bias_filler {
      type: "constant"
    }
  }
}
layer {
  name: "relu1_p"
  type: "ReLU"
  bottom: "ip1_p"
  top: "ip1_p"
}
layer {
  name: "ip2_p"
  type: "InnerProduct"
  bottom: "ip1_p"
  top: "ip2_p"
  param {
    name: "ip2_w"
    lr_mult: 1
  }
  param {
    name: "ip2_b"
    lr_mult: 2
  }
  inner_product_param {
    num_output: 10
    weight_filler {
      type: "xavier"
    }
    bias_filler {
      type: "constant"
    }
  }
}
layer {
  name: "feat_p"
  type: "InnerProduct"
  bottom: "ip2_p"
  top: "feat_p"
  param {
    name: "feat_w"
    lr_mult: 1
  }
  param {
    name: "feat_b"
    lr_mult: 2
  }
  inner_product_param {
    num_output: 2
    weight_filler {
      type: "xavier"
    }
    bias_filler {
      type: "constant"
    }
  }
}
layer {
  name: "loss"
  type: "ContrastiveLoss"
  bottom: "feat"
  bottom: "feat_p"
  bottom: "sim"
  top: "loss"
  contrastive_loss_param {
    margin: 1
  }
}
I0607 15:28:54.765808 1956823808 layer_factory.hpp:74] Creating layer pair_data
I0607 15:28:54.765820 1956823808 net.cpp:69] Creating Layer pair_data
I0607 15:28:54.765825 1956823808 net.cpp:341] pair_data -> pair_data
I0607 15:28:54.765833 1956823808 net.cpp:341] pair_data -> sim
I0607 15:28:54.765841 1956823808 net.cpp:98] Setting up pair_data
I0607 15:28:54.766981 1956823808 db.cpp:20] Opened leveldb src/siamese_network_bw/data/siamese_network_validation_leveldb
I0607 15:28:54.767434 1956823808 data_layer.cpp:65] output data size: 100,2,62,47
I0607 15:28:54.768318 1956823808 net.cpp:105] Top shape: 100 2 62 47 (582800)
I0607 15:28:54.768326 1956823808 net.cpp:105] Top shape: 100 1 1 1 (100)
I0607 15:28:54.768329 1956823808 layer_factory.hpp:74] Creating layer slice_pair
I0607 15:28:54.768337 1956823808 net.cpp:69] Creating Layer slice_pair
I0607 15:28:54.768340 1956823808 net.cpp:379] slice_pair <- pair_data
I0607 15:28:54.768345 1956823808 net.cpp:341] slice_pair -> data
I0607 15:28:54.768355 1956823808 net.cpp:341] slice_pair -> data_p
I0607 15:28:54.768362 1956823808 net.cpp:98] Setting up slice_pair
I0607 15:28:54.768367 1956823808 net.cpp:105] Top shape: 100 1 62 47 (291400)
I0607 15:28:54.768370 1956823808 net.cpp:105] Top shape: 100 1 62 47 (291400)
I0607 15:28:54.768374 1956823808 layer_factory.hpp:74] Creating layer conv1
I0607 15:28:54.768380 1956823808 net.cpp:69] Creating Layer conv1
I0607 15:28:54.768389 1956823808 net.cpp:379] conv1 <- data
I0607 15:28:54.768395 1956823808 net.cpp:341] conv1 -> conv1
I0607 15:28:54.768401 1956823808 net.cpp:98] Setting up conv1
I0607 15:28:54.768659 1956823808 net.cpp:105] Top shape: 100 20 58 43 (4988000)
I0607 15:28:54.768671 1956823808 layer_factory.hpp:74] Creating layer pool1
I0607 15:28:54.768677 1956823808 net.cpp:69] Creating Layer pool1
I0607 15:28:54.768681 1956823808 net.cpp:379] pool1 <- conv1
I0607 15:28:54.768687 1956823808 net.cpp:341] pool1 -> pool1
I0607 15:28:54.768692 1956823808 net.cpp:98] Setting up pool1
I0607 15:28:54.768733 1956823808 net.cpp:105] Top shape: 100 20 29 22 (1276000)
I0607 15:28:54.768738 1956823808 layer_factory.hpp:74] Creating layer conv2
I0607 15:28:54.768744 1956823808 net.cpp:69] Creating Layer conv2
I0607 15:28:54.768748 1956823808 net.cpp:379] conv2 <- pool1
I0607 15:28:54.768753 1956823808 net.cpp:341] conv2 -> conv2
I0607 15:28:54.768759 1956823808 net.cpp:98] Setting up conv2
I0607 15:28:54.769117 1956823808 net.cpp:105] Top shape: 100 50 25 18 (2250000)
I0607 15:28:54.769127 1956823808 layer_factory.hpp:74] Creating layer pool2
I0607 15:28:54.769135 1956823808 net.cpp:69] Creating Layer pool2
I0607 15:28:54.769140 1956823808 net.cpp:379] pool2 <- conv2
I0607 15:28:54.769350 1956823808 net.cpp:341] pool2 -> pool2
I0607 15:28:54.769368 1956823808 net.cpp:98] Setting up pool2
I0607 15:28:54.769541 1956823808 net.cpp:105] Top shape: 100 50 13 9 (585000)
I0607 15:28:54.769553 1956823808 layer_factory.hpp:74] Creating layer ip1
I0607 15:28:54.769565 1956823808 net.cpp:69] Creating Layer ip1
I0607 15:28:54.769572 1956823808 net.cpp:379] ip1 <- pool2
I0607 15:28:54.769582 1956823808 net.cpp:341] ip1 -> ip1
I0607 15:28:54.769595 1956823808 net.cpp:98] Setting up ip1
I0607 15:28:54.788730 1956823808 net.cpp:105] Top shape: 100 500 1 1 (50000)
I0607 15:28:54.788753 1956823808 layer_factory.hpp:74] Creating layer relu1
I0607 15:28:54.788761 1956823808 net.cpp:69] Creating Layer relu1
I0607 15:28:54.788765 1956823808 net.cpp:379] relu1 <- ip1
I0607 15:28:54.788771 1956823808 net.cpp:330] relu1 -> ip1 (in-place)
I0607 15:28:54.788779 1956823808 net.cpp:98] Setting up relu1
I0607 15:28:54.788846 1956823808 net.cpp:105] Top shape: 100 500 1 1 (50000)
I0607 15:28:54.788852 1956823808 layer_factory.hpp:74] Creating layer ip2
I0607 15:28:54.788861 1956823808 net.cpp:69] Creating Layer ip2
I0607 15:28:54.788864 1956823808 net.cpp:379] ip2 <- ip1
I0607 15:28:54.788873 1956823808 net.cpp:341] ip2 -> ip2
I0607 15:28:54.788882 1956823808 net.cpp:98] Setting up ip2
I0607 15:28:54.788926 1956823808 net.cpp:105] Top shape: 100 10 1 1 (1000)
I0607 15:28:54.788933 1956823808 layer_factory.hpp:74] Creating layer feat
I0607 15:28:54.788939 1956823808 net.cpp:69] Creating Layer feat
I0607 15:28:54.788944 1956823808 net.cpp:379] feat <- ip2
I0607 15:28:54.788954 1956823808 net.cpp:341] feat -> feat
I0607 15:28:54.788962 1956823808 net.cpp:98] Setting up feat
I0607 15:28:54.788991 1956823808 net.cpp:105] Top shape: 100 2 1 1 (200)
I0607 15:28:54.789011 1956823808 layer_factory.hpp:74] Creating layer conv1_p
I0607 15:28:54.789019 1956823808 net.cpp:69] Creating Layer conv1_p
I0607 15:28:54.789049 1956823808 net.cpp:379] conv1_p <- data_p
I0607 15:28:54.789063 1956823808 net.cpp:341] conv1_p -> conv1_p
I0607 15:28:54.789072 1956823808 net.cpp:98] Setting up conv1_p
I0607 15:28:54.789311 1956823808 net.cpp:105] Top shape: 100 20 58 43 (4988000)
I0607 15:28:54.789321 1956823808 net.cpp:423] Sharing parameters 'conv1_w' owned by layer 'conv1', param index 0
I0607 15:28:54.789332 1956823808 net.cpp:423] Sharing parameters 'conv1_b' owned by layer 'conv1', param index 1
I0607 15:28:54.789337 1956823808 layer_factory.hpp:74] Creating layer pool1_p
I0607 15:28:54.789345 1956823808 net.cpp:69] Creating Layer pool1_p
I0607 15:28:54.789347 1956823808 net.cpp:379] pool1_p <- conv1_p
I0607 15:28:54.789353 1956823808 net.cpp:341] pool1_p -> pool1_p
I0607 15:28:54.789361 1956823808 net.cpp:98] Setting up pool1_p
I0607 15:28:54.789402 1956823808 net.cpp:105] Top shape: 100 20 29 22 (1276000)
I0607 15:28:54.789407 1956823808 layer_factory.hpp:74] Creating layer conv2_p
I0607 15:28:54.789413 1956823808 net.cpp:69] Creating Layer conv2_p
I0607 15:28:54.789417 1956823808 net.cpp:379] conv2_p <- pool1_p
I0607 15:28:54.789423 1956823808 net.cpp:341] conv2_p -> conv2_p
I0607 15:28:54.789430 1956823808 net.cpp:98] Setting up conv2_p
I0607 15:28:54.789813 1956823808 net.cpp:105] Top shape: 100 50 25 18 (2250000)
I0607 15:28:54.789824 1956823808 net.cpp:423] Sharing parameters 'conv2_w' owned by layer 'conv2', param index 0
I0607 15:28:54.789829 1956823808 net.cpp:423] Sharing parameters 'conv2_b' owned by layer 'conv2', param index 1
I0607 15:28:54.789832 1956823808 layer_factory.hpp:74] Creating layer pool2_p
I0607 15:28:54.789839 1956823808 net.cpp:69] Creating Layer pool2_p
I0607 15:28:54.789841 1956823808 net.cpp:379] pool2_p <- conv2_p
I0607 15:28:54.789846 1956823808 net.cpp:341] pool2_p -> pool2_p
I0607 15:28:54.789852 1956823808 net.cpp:98] Setting up pool2_p
I0607 15:28:54.789894 1956823808 net.cpp:105] Top shape: 100 50 13 9 (585000)
I0607 15:28:54.789899 1956823808 layer_factory.hpp:74] Creating layer ip1_p
I0607 15:28:54.789906 1956823808 net.cpp:69] Creating Layer ip1_p
I0607 15:28:54.789908 1956823808 net.cpp:379] ip1_p <- pool2_p
I0607 15:28:54.789935 1956823808 net.cpp:341] ip1_p -> ip1_p
I0607 15:28:54.789942 1956823808 net.cpp:98] Setting up ip1_p
I0607 15:28:54.811713 1956823808 net.cpp:105] Top shape: 100 500 1 1 (50000)
I0607 15:28:54.811736 1956823808 net.cpp:423] Sharing parameters 'ip1_w' owned by layer 'ip1', param index 0
I0607 15:28:54.812932 1956823808 net.cpp:423] Sharing parameters 'ip1_b' owned by layer 'ip1', param index 1
I0607 15:28:54.812949 1956823808 layer_factory.hpp:74] Creating layer relu1_p
I0607 15:28:54.812959 1956823808 net.cpp:69] Creating Layer relu1_p
I0607 15:28:54.812964 1956823808 net.cpp:379] relu1_p <- ip1_p
I0607 15:28:54.812971 1956823808 net.cpp:330] relu1_p -> ip1_p (in-place)
I0607 15:28:54.812978 1956823808 net.cpp:98] Setting up relu1_p
I0607 15:28:54.813336 1956823808 net.cpp:105] Top shape: 100 500 1 1 (50000)
I0607 15:28:54.813350 1956823808 layer_factory.hpp:74] Creating layer ip2_p
I0607 15:28:54.813385 1956823808 net.cpp:69] Creating Layer ip2_p
I0607 15:28:54.813392 1956823808 net.cpp:379] ip2_p <- ip1_p
I0607 15:28:54.813407 1956823808 net.cpp:341] ip2_p -> ip2_p
I0607 15:28:54.813426 1956823808 net.cpp:98] Setting up ip2_p
I0607 15:28:54.813484 1956823808 net.cpp:105] Top shape: 100 10 1 1 (1000)
I0607 15:28:54.813495 1956823808 net.cpp:423] Sharing parameters 'ip2_w' owned by layer 'ip2', param index 0
I0607 15:28:54.813504 1956823808 net.cpp:423] Sharing parameters 'ip2_b' owned by layer 'ip2', param index 1
I0607 15:28:54.813511 1956823808 layer_factory.hpp:74] Creating layer feat_p
I0607 15:28:54.813521 1956823808 net.cpp:69] Creating Layer feat_p
I0607 15:28:54.813527 1956823808 net.cpp:379] feat_p <- ip2_p
I0607 15:28:54.813537 1956823808 net.cpp:341] feat_p -> feat_p
I0607 15:28:54.813549 1956823808 net.cpp:98] Setting up feat_p
I0607 15:28:54.813563 1956823808 net.cpp:105] Top shape: 100 2 1 1 (200)
I0607 15:28:54.813572 1956823808 net.cpp:423] Sharing parameters 'feat_w' owned by layer 'feat', param index 0
I0607 15:28:54.813580 1956823808 net.cpp:423] Sharing parameters 'feat_b' owned by layer 'feat', param index 1
I0607 15:28:54.813586 1956823808 layer_factory.hpp:74] Creating layer loss
I0607 15:28:54.813596 1956823808 net.cpp:69] Creating Layer loss
I0607 15:28:54.813601 1956823808 net.cpp:379] loss <- feat
I0607 15:28:54.813607 1956823808 net.cpp:379] loss <- feat_p
I0607 15:28:54.813614 1956823808 net.cpp:379] loss <- sim
I0607 15:28:54.813629 1956823808 net.cpp:341] loss -> loss
I0607 15:28:54.813640 1956823808 net.cpp:98] Setting up loss
I0607 15:28:54.813650 1956823808 net.cpp:105] Top shape: 1 1 1 1 (1)
I0607 15:28:54.813657 1956823808 net.cpp:111]     with loss weight 1
I0607 15:28:54.813668 1956823808 net.cpp:156] loss needs backward computation.
I0607 15:28:54.813675 1956823808 net.cpp:156] feat_p needs backward computation.
I0607 15:28:54.813688 1956823808 net.cpp:156] ip2_p needs backward computation.
I0607 15:28:54.813699 1956823808 net.cpp:156] relu1_p needs backward computation.
I0607 15:28:54.813704 1956823808 net.cpp:156] ip1_p needs backward computation.
I0607 15:28:54.813715 1956823808 net.cpp:156] pool2_p needs backward computation.
I0607 15:28:54.813721 1956823808 net.cpp:156] conv2_p needs backward computation.
I0607 15:28:54.813727 1956823808 net.cpp:156] pool1_p needs backward computation.
I0607 15:28:54.813733 1956823808 net.cpp:156] conv1_p needs backward computation.
I0607 15:28:54.813738 1956823808 net.cpp:156] feat needs backward computation.
I0607 15:28:54.813745 1956823808 net.cpp:156] ip2 needs backward computation.
I0607 15:28:54.813751 1956823808 net.cpp:156] relu1 needs backward computation.
I0607 15:28:54.813757 1956823808 net.cpp:156] ip1 needs backward computation.
I0607 15:28:54.813763 1956823808 net.cpp:156] pool2 needs backward computation.
I0607 15:28:54.813768 1956823808 net.cpp:156] conv2 needs backward computation.
I0607 15:28:54.813774 1956823808 net.cpp:156] pool1 needs backward computation.
I0607 15:28:54.813781 1956823808 net.cpp: